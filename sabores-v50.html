<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Sabores - Catálogo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
     body {
      background: radial-gradient(circle at top, #0f0f0f, #000);
      color: #00ffcc;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 30px 20px;
      margin: 0;
    }

    h1 {
      text-align: center;
      font-size: 2.2em;
      margin-bottom: 40px;
      color: #00ffcc;
      text-shadow: 0 0 15px #00ffccaa;
    }

    h2 {
      color: #00ffff;
      border-bottom: 2px solid #00ffcc44;
      padding-bottom: 10px;
      margin-top: 50px;
      text-align: center;
    }

    section {
      max-width: 800px;
      margin: 0 auto 50px auto;
      background-color: #111;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 0 15px #00ffcc33;
    }

    .sabores {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      list-style: none;
      padding: 0;
      gap: 12px;
      margin-top: 20px;
    }

    .sabores li a {
      display: inline-block;
      background: #000;
      border: 1px solid #00ffcc;
      border-radius: 20px;
      padding: 10px 20px;
      font-size: 0.95em;
      color: #fff;
      text-decoration: none;
      box-shadow: 0 0 6px #00ffcc22;
      transition: all 0.3s ease;
    }

    .sabores li a:hover {
      background: #00ffcc;
      color: #000;
      transform: scale(1.05);
      box-shadow: 0 0 15px #00ffccaa;
    }

    @media (max-width: 600px) {
      .sabores li a {
        padding: 8px 14px;
        font-size: 0.9em;
      }
    }

    .produto { text-align: center; }

    .indisponivel {
      background-color: #ff0000;
      color: white;
      border: none;
      padding: 10px 20px;
      font-size: 1rem;
      border-radius: 8px;
      cursor: not-allowed;
      opacity: 0.7;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .msg-erro {
      color: #ff7a7a;
      text-align: center;
      font-size: 0.95em;
      margin-top: 12px;
    }
  </style>
</head>
<body>
  <h1>Clique no seu sabor favorito e receba rapidinho!</h1>

  <!-- Obs: o atributo data-produto DEVE combinar com a coluna "produto" na planilha -->
  <section id="blacksheep20k" data-produto="blacksheep20k">
    <h2>BLACK SHEEP 20K</h2>
    <img src="img/BLACK-SHEEP-20K.jpg" alt="BLACK-SHEEP-20K" style="display: block; margin: 0 auto; max-width: 100%; width: 250px; height: auto;">
    <ul class="sabores"></ul>
  </section>

  <section id="blacksheeprefil" data-produto="blacksheeprefil">
    <h2>BLACK SHEEP REFIL 30K</h2>
    <img src="img/BLACK-SHEEP-REFIL-30K.jpeg" alt="BLACK-SHEEP-REFIL-30K" style="display: block; margin: 0 auto; max-width: 100%; width: 250px; height: auto;">
    <ul class="sabores"></ul>
  </section>

  <section id="iceking" data-produto="iceking">
    <h2>ELFBAR ICE KING 40K</h2>
    <img src="img/ELFBAR-ICE-KING-40K.jpg" alt="ELFBAR-ICE-KING-40K" style="display: block; margin: 0 auto; max-width: 100%; width: 250px; height: auto;">
    <ul class="sabores"></ul>
  </section>

  <section id="elfbar" data-produto="elfbar30k">
    <h2>ELFBAR TE 30K</h2>
    <img src="img/ELFBAR-TE-30.jpg" alt="ELFBAR-TE-30K" style="display: block; margin: 0 auto; max-width: 100%; width: 250px; height: auto;">
    <ul class="sabores"></ul>
  </section>

  <section id="v80" data-produto="ignitev80">
    <h2>IGNITE V80 BLACK</h2>
    <img src="img/IGNITE-V80-BLACK.jpg" alt="IGNITE-V80-BLACK" style="display: block; margin: 0 auto; max-width: 100%; width: 250px; height: auto;">
    <ul class="sabores"></ul>
  </section>

  <section id="ignitep100" data-produto="ignitep100">
    <h2>IGNITE P100</h2>
    <img src="img/IGNITE-P100.jpg" alt="IGNITE-P100" style="display: block; margin: 0 auto; max-width: 100%; width: 250px; height: auto;">
    <ul class="sabores"></ul>
  </section>

  <section id="v120" data-produto="ignitev120">
    <h2>IGNITE V120</h2>
    <img src="img/ignite-v120-coffe.jpg" alt="IGNITE-V120" style="display: block; margin: 0 auto; max-width: 100%; width: 250px; height: auto;">
    <ul class="sabores"></ul>
  </section>

  <section id="v120gold" data-produto="ignitep120gold">
    <h2>IGNITE P120 GOLD</h2>
    <img src="img/IGNITE-V120-GOLD.jpg" alt="IGNITE-P120-GOLD" style="display: block; margin: 0 auto; max-width: 100%; width: 250px; height: auto;">
    <ul class="sabores"></ul>
  </section>

  <section id="v150" data-produto="ignitev150pro">
    <h2>IGNITE V150 PRO</h2>
    <img src="img/IGNITE-V150-PRO.jpg" alt="IGNITE-V150-PRO" style="display: block; margin: 0 auto; max-width: 100%; width: 250px; height: auto;">
    <ul class="sabores"></ul>
  </section>

  <section id="v250" data-produto="ignitev250">
    <h2>IGNITE V250</h2>
    <img src="img/IGNITE-V250.jpg" alt="IGNITE-V250" style="display: block; margin: 0 auto; max-width: 100%; width: 250px; height: auto;">
    <ul class="sabores"></ul>
  </section>

  <section id="v300" data-produto="ignitev300">
    <h2>IGNITE V300</h2>
    <img src="img/IGNITE-V300-30k.jpg" alt="IGNITE-V300-30k" style="display: block; margin: 0 auto; max-width: 100%; width: 250px; height: auto;">
    <ul class="sabores"></ul>
  </section>

  <section id="v400" data-produto="ignitev400">
    <h2>IGNITE V400</h2>
    <img src="img/v400.jpeg" alt="IGNITE-V400" style="display: block; margin: 0 auto; max-width: 100%; width: 250px; height: auto;">
    <ul class="sabores"></ul>
  </section>

  <section id="losty" data-produto="lostyangel20k">
    <h2>LOSTY ANGEL 20K</h2>
    <img src="img/LOST-ANGE%20-20K.jpg" alt="LOSTY-ANGEL-20K" style="display: block; margin: 0 auto; max-width: 100%; width: 250px; height: auto;">
    <ul class="sabores"></ul>
  </section>

  <section id="refiloxbar" data-produto="refiloxbar">
    <h2>REFIL OXBAR</h2>
    <img src="img/O-REFIL-OXBAR-G32K.jpg" alt="O-REFIL-OXBAR-G32K" style="display: block; margin: 0 auto; max-width: 100%; width: 250px; height: auto;">
    <ul class="sabores"></ul>
  </section>

  <section id="liferef10k" data-produto="liferef10k">
    <h2>REFIL LIFE 10K</h2>
    <img src="img/REFIL-LIFE-POD.jpeg" alt="REFIL-LIFE-10K" style="display: block; margin: 0 auto; max-width: 100%; width: 250px; height: auto;">
    <ul class="sabores"></ul>
  </section>

  <section id="liferef8k" data-produto="liferef8k">
    <h2>REFIL LIFE 8K</h2>
    <img src="img/REFIL-LIFE-POD.jpeg" alt="REFIL-LIFE-8K" style="display: block; margin: 0 auto; max-width: 100%; width: 250px; height: auto;">
    <ul class="sabores"></ul>
  </section>

  <section id="vozoll" data-produto="vozoll20kpower">
    <h2>VOZOLL 20K POWER</h2>
    <img src="img/VOZOLL20KPOWER.jpeg" alt="VOZOLL-20K-POWER" style="display: block; margin: 0 auto; max-width: 100%; width: 250px; height: auto;">
    <ul class="sabores"></ul>
  </section>

  <section id="losgal" data-produto="losgal25k">
    <h2>LOSGAL 25K</h2>
    <img src="img/LOSGAL.jpg" alt="LOSGAL-25K" style="display: block; margin: 0 auto; max-width: 100%; width: 250px; height: auto;">
    <ul class="sabores"></ul>
  </section>

  <section id="asparkkit" data-produto="asparkemag20k">
    <h2>ASPARK EMAG 20K</h2>
    <img src="img/ASPARK-KIT.jpeg" alt="ASPARK-EMAG-20K" style="display: block; margin: 0 auto; max-width: 100%; width: 250px; height: auto;">
    <ul class="sabores"></ul>
  </section>

  <script>
    // >>> Substitua abaixo pela URL CSV publicada da sua planilha <<<
    const SHEET_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQestH5Bew_6ivl5vs3AxAFmHi23SPcBiPt9nEEi3SKZCK67wsfUrM7qNtQUvCuk7MVbQD_5bXfFYtf/pub?output=csv";

    function parseCSV(text) {
      // Parser simples com suporte a valores entre aspas contendo vírgulas
      const rows = [];
      let row = [];
      let cur = '';
      let insideQuotes = false;

      for (let i = 0; i < text.length; i++) {
        const ch = text[i];
        const next = text[i + 1];

        if (ch === '"') {
          if (insideQuotes && next === '"') {
            // aspas escapadas
            cur += '"';
            i++;
          } else {
            insideQuotes = !insideQuotes;
          }
        } else if (ch === ',' && !insideQuotes) {
          row.push(cur);
          cur = '';
        } else if ((ch === '\\n' || ch === '\\r') && !insideQuotes) {
          // nada (vamos tratar por split depois)
          cur += ch;
        } else {
          cur += ch;
        }
      }
      // Fallback: usar split por linhas e depois separar por vírgula respeitando aspas
      return text.trim().split(/\\r?\\n/).map(line => {
        const out = [];
        let val = '';
        let q = false;
        for (let j = 0; j < line.length; j++) {
          const c = line[j];
          const n = line[j+1];
          if (c === '"' ) {
            if (q && n === '"') { val += '"'; j++; }
            else { q = !q; }
          } else if (c === ',' && !q) {
            out.push(val); val = '';
          } else {
            val += c;
          }
        }
        out.push(val);
        return out;
      });
    }

    async function carregarSabores() {
      const sections = document.querySelectorAll('section[data-produto]');
      if (!sections.length) return;

      if (!SHEET_CSV_URL || SHEET_CSV_URL.includes('COLE_AQUI_A_URL_DO_CSV')) {
        sections.forEach(sec => {
          const ul = sec.querySelector('.sabores');
          if (ul) ul.innerHTML = '<li><div class="msg-erro">Configure a URL da planilha (CSV) no script.</div></li>';
        });
        return;
      }

      try {
        const res = await fetch(SHEET_CSV_URL + (SHEET_CSV_URL.includes('?') ? '&' : '?') + '_=' + Date.now());
        if (!res.ok) throw new Error('Falha ao baixar CSV');
        const csvText = await res.text();

        const rows = parseCSV(csvText);
        const header = rows.shift().map(h => h.trim().toLowerCase());
        const idx = {
          produto: header.indexOf('produto'),
          sabor: header.indexOf('sabor'),
          disponivel: header.indexOf('disponivel'),
          link: header.indexOf('link'),
        };
        if (Object.values(idx).some(v => v === -1)) {
          throw new Error('Cabeçalho da planilha deve conter: produto, sabor, disponivel, link');
        }

        const porProduto = {};
        rows.forEach(cols => {
          const produto = (cols[idx.produto] || '').trim();
          const sabor = (cols[idx.sabor] || '').trim();
          const dispRaw = (cols[idx.disponivel] || '').trim().toLowerCase();
          const link = (cols[idx.link] || '').trim();

          const disponivel = ['true', '1', 'sim', 'yes'].includes(dispRaw);
          if (produto && sabor && link && disponivel) {
            (porProduto[produto] ||= []).push({ sabor, link });
          }
        });

        sections.forEach(sec => {
          const slug = sec.dataset.produto;
          const ul = sec.querySelector('.sabores');
          const lista = porProduto[slug] || [];
          ul.innerHTML = lista.length
            ? lista.map(item => `<li><a href="${item.link}" target="_blank" rel="noopener noreferrer">${item.sabor}</a></li>`).join('')
            : `<li><button class="indisponivel" disabled>Sem estoque</button></li>`;
        });
      } catch (err) {
        console.error(err);
        sections.forEach(sec => {
          const ul = sec.querySelector('.sabores');
          if (ul) ul.innerHTML = '<li><div class="msg-erro">Não foi possível carregar os sabores agora. Tente novamente.</div></li>';
        });
      }
    }

    document.addEventListener('DOMContentLoaded', carregarSabores);
  </script>
</body>
</html>
